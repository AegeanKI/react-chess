(this["webpackJsonpreact-chess"]=this["webpackJsonpreact-chess"]||[]).push([[0],{11:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(0),o=a(6),i=a(5),c=a(3),s=a(4),u=a(8),l=a(7),y=a.n(l),p=a(10),h=a.n(p),b=(a(16),a(2));function f(e,t){return{y:e,x:t}}function v(){var e=Array(8).fill(0).map((function(e){return Array(8).fill(null)}));return Object(u.a)(Array(8)).map((function(e,t){return f(1,t)})).forEach((function(t,a){return e[t.y][t.x]=new x("black")})),Object(u.a)(Array(8)).map((function(e,t){return f(6,t)})).forEach((function(t,a){return e[t.y][t.x]=new x("white")})),[f(0,0),f(0,7),f(7,0),f(7,7)].forEach((function(t,a){return e[t.y][t.x]=new O("black")})),[f(7,0),f(7,7)].forEach((function(t,a){return e[t.y][t.x]=new O("white")})),[f(0,1),f(0,6)].forEach((function(t,a){return e[t.y][t.x]=new k("black")})),[f(7,1),f(7,6)].forEach((function(t,a){return e[t.y][t.x]=new k("white")})),[f(0,2),f(0,5)].forEach((function(t,a){return e[t.y][t.x]=new d("black")})),[f(7,2),f(7,5)].forEach((function(t,a){return e[t.y][t.x]=new d("white")})),[f(0,3)].forEach((function(t,a){return e[t.y][t.x]=new g("black")})),[f(7,3)].forEach((function(t,a){return e[t.y][t.x]=new g("white")})),[f(0,4)].forEach((function(t,a){return e[t.y][t.x]=new C("black")})),[f(7,4)].forEach((function(t,a){return e[t.y][t.x]=new C("white")})),e}var j=function(){function e(t,a){Object(c.a)(this,e),this.pieceColor=t,this.pieceType=a,this.moved=!1}return Object(s.a)(e,[{key:"hasPiece",value:function(e,t){return t[e.y][e.x]}},{key:"isValidCoord",value:function(e){return e.y>=0&&e.y<8&&e.x>=0&&e.x<8}},{key:"isSamePieceColor",value:function(e,t){return t[e.y][e.x].pieceColor===this.pieceColor}},{key:"canEatPiece",value:function(e,t){return this.isValidCoord(e)&&this.hasPiece(e,t)&&!this.isSamePieceColor(e,t)}},{key:"getCanMovePositionInGeneralRule",value:function(e,t){}},{key:"updateCanMovePositionInSpecialRule",value:function(e,t,a){return a}},{key:"getCanMovePosition",value:function(e,t,a){var n=this.getCanMovePositionInGeneralRule(e,t);return n=this.updateCanMovePositionInSpecialRule(e,t,n,a)}},{key:"isUsingSpeicalRule",value:function(e,t,a){return!1}},{key:"updateSquaresUsingSpecialRule",value:function(e,t,a){return e}},{key:"updateSquaresUsingEnPassant",value:function(e,t,a){return e}},{key:"updateSquares",value:function(e,t,a){var n=e.map((function(e){return e.slice()}));return n[t.y][t.x].isUsingSpeicalRule(n,t,a)&&(n=n[t.y][t.x].updateSquaresUsingSpecialRule(n,t,a)),n[a.y][a.x]=n[t.y][t.x],n[t.y][t.x]=null,n[a.y][a.x].moved=!0,null===e[t.y][t.x]&&console.log("something wrong"),n}},{key:"tryToEnPassant",value:function(e){return!1}}]),e}(),x=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e,"pawn")}return Object(s.a)(a,[{key:"getCanMovePositionInGeneralRule",value:function(e,t){var o="white"===this.pieceColor?6:1,i="white"===this.pieceColor?-1:1,c=f(e.y+i,e.x),s=f(e.y+2*i,e.x),u=[];return Object(n.a)(Object(r.a)(a.prototype),"isValidCoord",this).call(this,c)&&!Object(n.a)(Object(r.a)(a.prototype),"hasPiece",this).call(this,c,t)&&u.push(c),e.y!==o||Object(n.a)(Object(r.a)(a.prototype),"hasPiece",this).call(this,c,t)||Object(n.a)(Object(r.a)(a.prototype),"hasPiece",this).call(this,s,t)||u.push(s),u}},{key:"updateCanMovePositionInSpecialRule",value:function(e,t,o,i){var c="white"===this.pieceColor?-1:1,s=f(e.y+c,e.x+1),u=f(e.y+c,e.x-1);return Object(n.a)(Object(r.a)(a.prototype),"canEatPiece",this).call(this,s,t)&&o.push(s),Object(n.a)(Object(r.a)(a.prototype),"canEatPiece",this).call(this,u,t)&&o.push(u),i&&"pawn"===i.piece.pieceType&&2===Math.abs(i.startPos.y-i.endPos.y)&&1===Math.abs(i.startPos.x-e.x)&&i.endPos.y===e.y&&o.push(f(e.y+c,i.startPos.x)),o}},{key:"isUsingSpeicalRule",value:function(e,t,a){return"pawn"===e[t.y][t.x].pieceType&&1===Math.abs(t.x-a.x)&&null===e[a.y][a.x]}},{key:"updateSquaresUsingSpecialRule",value:function(e,t,a){var n=e.map((function(e){return e.slice()}));return n[t.y][a.x]=null,n}},{key:"tryToEnPassant",value:function(e){return 0===e.y||7===e.y}},{key:"updateSquaresUsingEnPassant",value:function(e,t,a){var n=e.map((function(e){return e.slice()})),r=a.y===t.y?new g(this.pieceColor):1===Math.abs(a.y-t.y)?new k(this.pieceColor):2===Math.abs(a.y-t.y)?new O(this.pieceColor):3===Math.abs(a.y-t.y)?new d(this.pieceColor):null;return n[t.y][t.x]=r,n}}]),a}(j),O=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e,"rock")}return Object(s.a)(a,[{key:"getCanMovePositionInGeneralRule",value:function(e,t){var o=this,i=[];return[[1,0],[0,1],[-1,0],[0,-1]].forEach((function(c){for(var s=f(e.y+c[0],e.x+c[1]);Object(n.a)(Object(r.a)(a.prototype),"isValidCoord",o).call(o,s)&&!Object(n.a)(Object(r.a)(a.prototype),"hasPiece",o).call(o,s,t);s=f(s.y+c[0],s.x+c[1]))i.push(s);Object(n.a)(Object(r.a)(a.prototype),"canEatPiece",o).call(o,s,t)&&i.push(s)})),i}}]),a}(j),d=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e,"bishop")}return Object(s.a)(a,[{key:"getCanMovePositionInGeneralRule",value:function(e,t){var o=this,i=[];return[[1,1],[1,-1],[-1,1],[-1,-1]].forEach((function(c){for(var s=f(e.y+c[0],e.x+c[1]);Object(n.a)(Object(r.a)(a.prototype),"isValidCoord",o).call(o,s)&&!Object(n.a)(Object(r.a)(a.prototype),"hasPiece",o).call(o,s,t);s=f(s.y+c[0],s.x+c[1]))i.push(s);Object(n.a)(Object(r.a)(a.prototype),"canEatPiece",o).call(o,s,t)&&i.push(s)})),i}}]),a}(j),g=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e,"queen")}return Object(s.a)(a,[{key:"getCanMovePositionInGeneralRule",value:function(e,t){var o=this,i=[];return[[1,0],[0,1],[-1,0],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]].forEach((function(c){for(var s=f(e.y+c[0],e.x+c[1]);Object(n.a)(Object(r.a)(a.prototype),"isValidCoord",o).call(o,s)&&!Object(n.a)(Object(r.a)(a.prototype),"hasPiece",o).call(o,s,t);s=f(s.y+c[0],s.x+c[1]))i.push(s);Object(n.a)(Object(r.a)(a.prototype),"canEatPiece",o).call(o,s,t)&&i.push(s)})),i}}]),a}(j),k=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e,"knight")}return Object(s.a)(a,[{key:"getCanMovePositionInGeneralRule",value:function(e,t){var o=this,i=[];return[[2,1],[-2,1],[2,-1],[-2,-1],[1,2],[1,-2],[-1,2],[-1,-2]].forEach((function(c){var s=f(e.y+c[0],e.x+c[1]);!Object(n.a)(Object(r.a)(a.prototype),"isValidCoord",o).call(o,s)||Object(n.a)(Object(r.a)(a.prototype),"hasPiece",o).call(o,s,t)&&Object(n.a)(Object(r.a)(a.prototype),"isSamePieceColor",o).call(o,s,t)||i.push(s)})),i}}]),a}(j),C=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e,"king")}return Object(s.a)(a,[{key:"getCanMovePositionInGeneralRule",value:function(e,t){var o=this,i=[];return[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[0,-1],[-1,0],[0,1]].forEach((function(c){var s=f(e.y+c[0],e.x+c[1]);!Object(n.a)(Object(r.a)(a.prototype),"isValidCoord",o).call(o,s)||Object(n.a)(Object(r.a)(a.prototype),"hasPiece",o).call(o,s,t)&&Object(n.a)(Object(r.a)(a.prototype),"isSamePieceColor",o).call(o,s,t)||i.push(s)})),i}},{key:"mayLoose",value:function(e,t,o,i){for(var c=Object(n.a)(Object(r.a)(a.prototype),"updateSquares",this).call(this,e,t,o),s=null,u=0;u<8;u++)for(var l=0;l<8;l++){if(c[u][l]&&!Object(n.a)(Object(r.a)(a.prototype),"isSamePieceColor",this).call(this,f(u,l),c))if("king"!==c[u][l].pieceType){if(c[u][l].getCanMovePosition(f(u,l),c,{startPos:t,endPos:o,piece:c[o.y][o.x]}).some((function(e){return e.y===o.y&&e.x===o.x})))return console.log(c[u][l].pieceColor,"-",c[u][l].pieceType," may cause lose"),!0}else s=f(u,l)}for(var y=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[0,-1],[-1,0],[0,1]],p=0;p<y.length;p++){var h=f(s.y+y[p][0],s.x+y[p][1]);if(h.y===o.y&&h.x===o.x)return!0}return!1}},{key:"updateCanMovePositionInSpecialRule",value:function(e,t,o,i){var c=this;if(o=o.filter((function(a){return!c.mayLoose(t,e,a,i)})),!Object(n.a)(Object(r.a)(a.prototype),"moved",this)){var s=[f(e.y,0),f(e.y,7)],u=[-1,1];s.forEach((function(s,l){var y=t[s.y][s.x];if(y&&"rock"===y.pieceType&&!y.moved){for(var p=f(e.y,e.x+u[l]);p.y!==s.y||p.x!==s.x;p=f(p.y,p.x+u[l]))if(Object(n.a)(Object(r.a)(a.prototype),"hasPiece",c).call(c,p,t))return;if(c.mayLoose(t,e,f(e.y,e.x+u[l]),i)||c.mayLoose(t,e,f(e.y,e.x+2*u[l]),i))return;o.push(f(e.y,e.x+2*u[l]))}}))}return o}},{key:"isUsingSpeicalRule",value:function(e,t,a){return"king"===e[t.y][t.x].pieceType&&2===Math.abs(t.x-a.x)}},{key:"updateSquaresUsingSpecialRule",value:function(e,t,a){var n=e.map((function(e){return e.slice()})),r=(a.x-t.x)/2,o=f(t.y,r>0?7:0);return n[t.y][a.x-r]=n[o.y][o.x],n[o.y][o.x]=null,n}}]),a}(j),m=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t="square "+this.props.squareBackgroundColor;return Object(b.jsxs)("button",{className:t,onClick:function(){return e.props.onClick()},children:[this.props.pieceImgSrc?Object(b.jsx)("img",{src:this.props.pieceImgSrc,alt:this.props.pieceImgSrc}):null,this.props.stackImgSrc?Object(b.jsx)("img",{className:"stack-image",src:this.props.stackImgSrc,alt:this.props.stackImgSrc}):null]})}}]),a}(y.a.Component),P=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"renderSquare",value:function(e){var t=this,a=8*e.y+e.x,n=this.props.squares[e.y][e.x],r=this.props.doingEnPassantCoord,o=r?this.props.squares[r.y][r.x]:null,i=this.props.mayMovePosition.some((function(t){return t.y===e.y&&t.x===e.x})),c=r&&e.x===r.x&&e.y===r.y?"orange-square":a===this.props.tryToMove?"yellow-square":(e.y+e.x)%2===0?"black-square":"white-square",s=r&&e.x===r.x&&Math.abs(e.y-r.y)<4?"light-mask":!r||e.x===r.x&&e.y===r.y?null:"dark-mask",u=i&&n&&n.pieceType?"/react-chess/circle.png":i?"/react-chess/dot.png":s?"/react-chess/"+s+".png":null,l="light-mask"===s&&"orange-square"===c?"/react-chess/"+o.pieceColor+"-queen.png":"light-mask"===s&&1===Math.abs(e.y-r.y)?"/react-chess/"+o.pieceColor+"-knight.png":"light-mask"===s&&2===Math.abs(e.y-r.y)?"/react-chess/"+o.pieceColor+"-rock.png":"light-mask"===s&&3===Math.abs(e.y-r.y)?"/react-chess/"+o.pieceColor+"-bishop.png":n?"/react-chess/"+n.pieceColor+"-"+n.pieceType+".png":null;return Object(b.jsx)(m,{pieceImgSrc:l,stackImgSrc:u,squareBackgroundColor:c,mayMove:i,usingMask:s,onClick:function(){return t.props.onClick(e)}},a)}},{key:"renderIndicator",value:function(){}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"board-container",children:[Object(b.jsx)("div",{className:"indicator-container",children:!1}),Object(b.jsx)("div",{className:"indicator-container",children:!1}),Object(u.a)(Array(8)).map((function(t,a){return Object(b.jsx)("div",{className:"board-row",children:Object(u.a)(Array(8)).map((function(t,n){return e.renderSquare(f(a,n))}))},a)}))]})}}]),a}(y.a.Component),M=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={squares:v(),nextColor:"white",tryToMove:null,mayMovePosition:[],historyMove:[],doingEnPassantCoord:null},n}return Object(s.a)(a,[{key:"handleClick",value:function(e){var t=this.state.squares.map((function(e){return e.slice()})),a=this.state.historyMove.slice(),n=this.state.doingEnPassantCoord,r=this.state.tryToMove,o=[];if(n){if(Math.abs(n.y-e.y)>=4||n.x!==e.x)return;console.log("doing en passant"),t=t[n.y][n.x].updateSquaresUsingEnPassant(t,n,e),this.setState({squares:t,doingEnPassantCoord:null})}else r&&this.state.mayMovePosition.some((function(t){return t.y===e.y&&t.x===e.x}))?(t=t[r.y][r.x].updateSquares(t,r,e),a.push({startPos:r,endPos:e,piece:t[e.y][e.x]}),t[e.y][e.x].tryToEnPassant(e)&&this.setState({doingEnPassantCoord:e}),this.setState({squares:t,nextColor:"black"===this.state.nextColor?"white":"black",historyMove:a})):t[e.y][e.x]&&t[e.y][e.x].pieceColor===this.state.nextColor&&(r=e,o=t[e.y][e.x].getCanMovePosition(e,t,a[a.length-1]));this.setState({tryToMove:r,mayMovePosition:o})}},{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"game",children:Object(b.jsx)("div",{className:"game-board",children:Object(b.jsx)(P,{squares:this.state.squares,onClick:function(t){return e.handleClick(t)},tryToMove:this.state.tryToMove,mayMovePosition:this.state.mayMovePosition,doingEnPassantCoord:this.state.doingEnPassantCoord})})})}}]),a}(y.a.Component);h.a.render(Object(b.jsx)(M,{}),document.getElementById("root"))},16:function(e,t,a){}},[[11,1,2]]]);
//# sourceMappingURL=main.98063705.chunk.js.map